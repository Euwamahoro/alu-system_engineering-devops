#!/bin/bash
# Update Homebrew and install Nginx
brew update
brew install nginx

# Create necessary directories
sudo mkdir -p /usr/local/var/www

# Create the custom 404 page with the required string
echo '
<!DOCTYPE html>
<html>
<head>
    <title>404 Not Found</title>
</head>
<body>
    <h1>404 Not Found</h1>
    <p>Ceci n'"'"'est pas une page</p>
</body>
</html>
' | sudo tee /usr/local/var/www/404.html > /dev/null

# Update the Nginx configuration to use the custom 404 page
echo '
server {
    listen       8080;
    server_name  localhost;

    location / {
        root   /usr/local/var/www;
        index  index.html index.htm;
    }

    error_page 404 /404.html;
    location = /404.html {
        internal;
    }
}
' | sudo tee /usr/local/etc/nginx/nginx.conf > /dev/null

# Start Nginx service
brew services start nginx
