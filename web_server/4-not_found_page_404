#!/usr/bin/env bash
# Install Nginx using Homebrew
brew install nginx

# Create the required directories
sudo mkdir -p /usr/local/etc/nginx/html
sudo mkdir -p /usr/local/var/www

# Create the index.html file
echo "Holberton School" | sudo tee /usr/local/var/www/index.html > /dev/null

# Create the 404.html file with the required string
echo "Ceci n'est pas une page" | sudo tee /usr/local/etc/nginx/html/404.html > /dev/null

# Configure Nginx server
echo "
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    root /usr/local/var/www;
    index index.html index.htm;

    location /redirect_me {
        return 301 http://youtube.com/;
    }

    error_page 404 /404.html;
    location /404 {
        root /usr/local/etc/nginx/html;
        internal;
    }
}
" | sudo tee /usr/local/etc/nginx/nginx.conf > /dev/null

# Start Nginx service
brew services start nginx
