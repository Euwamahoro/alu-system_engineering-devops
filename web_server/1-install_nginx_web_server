#!/usr/bin/env bash
# Install Nginx using Homebrew
brew install nginx

# Create necessary directories
sudo mkdir -p /usr/local/var/www/html

# Create the HTML file
sudo bash -c 'echo "Holberton School for the win!" > /usr/local/var/www/html/index.html'

# Start Nginx service
brew services start nginx

# Wait for Nginx to start (adjust sleep time as needed)
sleep 3

# Confirm Nginx is listening on port 80
lsof -i :80

# Query the server and print the HTTP response code
response_code=$(curl -s -o /dev/null -w "%{http_code}" http://localhost)
echo "HTTP response code: $response_code"
